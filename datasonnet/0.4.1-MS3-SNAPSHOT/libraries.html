<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>DataSonnet Libraries :: DataSonnet Mapper Documentation</title>
    <link rel="canonical" href="https://MS3Inc.github.io/datasonnet-mapper/datasonnet/0.4.1-MS3-SNAPSHOT/libraries.html">
    <meta name="generator" content="Antora 2.3.3">
    <link rel="stylesheet" href="../../_/css/site.css">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://MS3Inc.github.io/datasonnet-mapper">DataSonnet Mapper Documentation</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="#">Home</a>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Products</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Product A</a>
            <a class="navbar-item" href="#">Product B</a>
            <a class="navbar-item" href="#">Product C</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Services</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Service A</a>
            <a class="navbar-item" href="#">Service B</a>
            <a class="navbar-item" href="#">Service C</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Resources</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Resource A</a>
            <a class="navbar-item" href="#">Resource B</a>
            <a class="navbar-item" href="#">Resource C</a>
          </div>
        </div>
        <div class="navbar-item">
          <span class="control">
            <a class="button is-primary" href="#">Download</a>
          </span>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="datasonnet" data-version="0.4.1-MS3-SNAPSHOT">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="index.html">DataSonnet</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="index.html">Introduction</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="quickstart.html">Quick Start</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="dataformats.html">Data Formats</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="headers.html">DataSonnet Header</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="jsonnet-doc.html">Standard Library Documentation</a>
  </li>
  <li class="nav-item is-current-page" data-depth="1">
    <a class="nav-link" href="libraries.html">Additional DataSonnet Libraries</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="cli.html">Command Line Interface</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="jar-cli.html">Using the CLI via a Jar</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="docker-cli.html">Using the CLI via Docker</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="cookbook.html">Cookbook</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="jar-lib.html">Using DataSonnet Programmatically</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="#intellij:ROOT:index.adoc">IntelliJ Plugin</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">DataSonnet</span>
    <span class="version">0.4.1-MS3-SNAPSHOT</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <span class="title">DataSonnet</span>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="index.html">0.4.1-MS3-SNAPSHOT</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="index.html">DataSonnet</a></li>
    <li><a href="libraries.html">Additional DataSonnet Libraries</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="https://github.com/MS3Inc/datasonnet-mapper/edit/main/docs/modules/ROOT/pages/libraries.adoc">Edit this Page</a></div>
  </div>
  <div class="content">
<article class="doc">
<h1 class="page">DataSonnet Libraries</h1>
<div id="toc" class="toc">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_crypto">Crypto</a></li>
<li><a href="#_zoneddatetime">ZonedDateTime</a></li>
<li><a href="#_localdatetime">LocalDateTime</a></li>
<li><a href="#_jsonpath">JsonPath</a></li>
<li><a href="#_util">Util</a></li>
<li><a href="#_regex">Regex</a></li>
<li><a href="#_url">URL</a></li>
</ul>
</div>
<div class="sect1">
<h2 id="_crypto"><a class="anchor" href="#_crypto"></a>Crypto</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_hashstring_value_string_algorithm"><a class="anchor" href="#_hashstring_value_string_algorithm"></a><code>hash(string value, string algorithm)</code></h3>
<div class="paragraph">
<p>Calculates hash of a String value using one of the supported algorithms. The <code>algorithm</code> must be one of <code>MD2</code>, <code>MD5</code>, <code>SHA-1</code>, <code>SHA-256</code>, <code>SHA-384</code>, <code>SHA-512</code>
The response is a string containing the hash bytes.</p>
</div>
<div class="paragraph">
<p><strong>Example:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>{
    hashValue: DS.Crypto.hash("HelloWorld", "MD5")
}</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Result</div>
<div class="content">
<pre>{
    "hashValue": "68e109f0f40ca72a15e05cc22786f8e6"
}</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_hmacstring_value_string_secret_string_algorithm"><a class="anchor" href="#_hmacstring_value_string_secret_string_algorithm"></a><code>hmac(string value, string secret, string algorithm)</code></h3>
<div class="paragraph">
<p>Generates hash-based message autentication code using provided secret and a hash function algorithm. The <code>algoritm</code> must be one of <code>HmacSHA1</code>, <code>HmacSHA256</code> or <code>HmacSHA512</code>.</p>
</div>
<div class="paragraph">
<p><strong>Example:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>{
    hmacValue: DS.Crypto.hmac("HelloWorld", "DataSonnet rules!", "HmacSHA256")
}</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Result</div>
<div class="content">
<pre>{
    "hmacValue": "7854220ef827b07529509f68f391a80bf87fff328dbda140ed582520a1372dc1"
}</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_encryptstring_value_string_key"><a class="anchor" href="#_encryptstring_value_string_key"></a><code>encrypt(string value, string key)</code></h3>
<div class="paragraph">
<p>Encrypts the string using the key and the Blowfish algorithm. The result is Base64-encoded encrypted string.</p>
</div>
<div class="paragraph">
<p><strong>Example:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>{
    passwd: DS.Crypto.encrypt("HelloWorld", "DataSonnet123")
}</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Result</div>
<div class="content">
<pre>{
    "passwd": "HdK8opktKiK3ero0RJiYbA=="
}</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_decryptstring_value_string_key"><a class="anchor" href="#_decryptstring_value_string_key"></a><code>decrypt(string value, string key)</code></h3>
<div class="paragraph">
<p>Decrypts the string using the key and the Blowfish algorithm.</p>
</div>
<div class="paragraph">
<p><strong>Example:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>{
    passwd: DS.Crypto.decrypt(payload.encryptedPassword, "MySecretKey")
}</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_zoneddatetime"><a class="anchor" href="#_zoneddatetime"></a>ZonedDateTime</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_now"><a class="anchor" href="#_now"></a><code>now()</code></h3>
<div class="paragraph">
<p>Returns the current date/time from the system UTC clock in ISO-8601 format.</p>
</div>
<div class="paragraph">
<p><strong>Example</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>{
    currentZuluTime: DS.ZonedDateTime.now()
}</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Result:</div>
<div class="content">
<pre>{
    "currentZuluTime": "2019-08-19T18:58:38.313Z"
}</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_offsetstring_datetime_string_period"><a class="anchor" href="#_offsetstring_datetime_string_period"></a><code>offset(string datetime, string period)</code></h3>
<div class="paragraph">
<p>Returns a copy of this datetime with the specified amount added. The <code>datetime</code> parameter is in the ISO-8601 format.
The <code>period</code> is a string in the ISO-8601 period format.</p>
</div>
<div class="paragraph">
<p><strong>Example</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>DS.ZonedDateTime.offset("2019-07-22T21:00:00Z", "P1Y1D")</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Result:</div>
<div class="content">
<pre>2020-07-23T21:00:00Z</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_formatstring_datetime_string_inputformat_string_outputformat"><a class="anchor" href="#_formatstring_datetime_string_inputformat_string_outputformat"></a><code>format(string datetime, string inputFormat, string outputFormat)</code></h3>
<div class="paragraph">
<p>Reformats a zoned date-time string.</p>
</div>
<div class="paragraph">
<p><strong>Example</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>DS.ZonedDateTime.format("2019-07-04T21:00:00Z", "yyyy-MM-dd'T'HH:mm:ssVV", "d MMM uuuu")</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Result:</div>
<div class="content">
<pre>4 Jul 2019</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_comparestring_datetime1_string_format1_string_datetime2_string_format2"><a class="anchor" href="#_comparestring_datetime1_string_format1_string_datetime2_string_format2"></a><code>compare(string datetime1, string format1, string datetime2, string format2)</code></h3>
<div class="paragraph">
<p>Returns 1 if datetime1 &gt; datetime2, -1 if datetime1 &lt; datetime2, 0 if datetime1 == datetime2.</p>
</div>
</div>
<div class="sect2">
<h3 id="_changetimezonestring_datetime_string_format_string_timezone"><a class="anchor" href="#_changetimezonestring_datetime_string_format_string_timezone"></a><code>changeTimeZone(string datetime, string format, string timezone)</code></h3>
<div class="paragraph">
<p>Changes the date timezone, retaining the instant. This normally results in a change to the local date-time.
The response is formatted using the same format as an input.</p>
</div>
<div class="paragraph">
<p><strong>Example</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>DS.ZonedDateTime.changeTimeZone("2019-07-04T21:00:00-0500", "yyyy-MM-dd'T'HH:mm:ssZ", "America/Los_Angeles")</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Result:</div>
<div class="content">
<pre>2019-07-04T19:00:00-0700</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_tolocaldatestring_datetime_string_format"><a class="anchor" href="#_tolocaldatestring_datetime_string_format"></a><code>toLocalDate(string datetime, string format)</code></h3>
<div class="paragraph">
<p>Returns only local date part of the <code>datetime</code> parameter in the ISO-8601 format without the offset.</p>
</div>
<div class="paragraph">
<p><strong>Example</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>DS.ZonedDateTime.toLocalDate("2019-07-04T21:00:00-0500", "yyyy-MM-dd'T'HH:mm:ssZ")</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Result:</div>
<div class="content">
<pre>2019-07-04</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_tolocaltimestring_datetime_string_format"><a class="anchor" href="#_tolocaltimestring_datetime_string_format"></a><code>toLocalTime(string datetime, string format)</code></h3>
<div class="paragraph">
<p>Returns only local time part of the <code>datetime</code> parameter in the ISO-8601 format without the offset.</p>
</div>
<div class="paragraph">
<p><strong>Example</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>DS.ZonedDateTime.toLocalTime("2019-07-04T21:00:00-0500", "yyyy-MM-dd'T'HH:mm:ssZ")</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Result:</div>
<div class="content">
<pre>21:00:00</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_tolocaldatetimestring_datetime_string_format"><a class="anchor" href="#_tolocaldatetimestring_datetime_string_format"></a><code>toLocalDateTime(string datetime, string format)</code></h3>
<div class="paragraph">
<p>Returns local datetime part of the <code>datetime</code> parameter in the ISO-8601 format without the offset.</p>
</div>
<div class="paragraph">
<p><strong>Example</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>DS.ZonedDateTime.toLocalDateTime("2019-07-04T21:00:00-0500", "yyyy-MM-dd'T'HH:mm:ssZ")</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Result:</div>
<div class="content">
<pre>2019-07-04T21:00:00</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_localdatetime"><a class="anchor" href="#_localdatetime"></a>LocalDateTime</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_now_2"><a class="anchor" href="#_now_2"></a><code>now()</code></h3>
<div class="paragraph">
<p>Returns the current date/time from the system UTC clock in ISO-8601 format without a time zone.</p>
</div>
<div class="paragraph">
<p><strong>Example</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>{
    currentLocalTime: DS.LocalDateTime.now()
}</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Result:</div>
<div class="content">
<pre>{
    "currentLocalTime": "2019-08-19T18:58:38.313"
}</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_offsetstring_datetime_string_period_2"><a class="anchor" href="#_offsetstring_datetime_string_period_2"></a><code>offset(string datetime, string period)</code></h3>
<div class="paragraph">
<p>Returns a copy of this datetime with the specified amount added. The <code>datetime</code> parameter is in the ISO-8601 format without an offset.
The <code>period</code> is a string in the ISO-8601 period format.</p>
</div>
<div class="paragraph">
<p><strong>Example</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>DS.LocalDateTime.offset("2019-07-22T21:00:00", "P1Y1D")</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Result:</div>
<div class="content">
<pre>2020-07-23T21:00:00</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_formatstring_datetime_string_inputformat_string_outputformat_2"><a class="anchor" href="#_formatstring_datetime_string_inputformat_string_outputformat_2"></a><code>format(string datetime, string inputFormat, string outputFormat)</code></h3>
<div class="paragraph">
<p>Reformats a local date-time string.</p>
</div>
<div class="paragraph">
<p><strong>Example</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>DS.LocalDateTime.format("2019-07-04T21:00:00", "yyyy-MM-dd'T'HH:mm:ss", "d MMM uuuu")</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Result:</div>
<div class="content">
<pre>4 Jul 2019</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_comparestring_datetime1_string_format1_string_datetime2_string_format2_2"><a class="anchor" href="#_comparestring_datetime1_string_format1_string_datetime2_string_format2_2"></a><code>compare(string datetime1, string format1, string datetime2, string format2)</code></h3>
<div class="paragraph">
<p>Returns <code>1</code> if <code>datetime1 &gt; datetime2</code>, <code>-1</code> if <code>datetime1 &lt; datetime2</code>, and <code>0</code> if <code>datetime1 == datetime2</code>.
The <code>format1</code> and <code>format2</code> parameters must not have an offset or time zone.</p>
</div>
<div class="paragraph">
<p><strong>Example</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>DS.LocalDateTime.compare("2019-07-04T21:00:00", "yyyy-MM-dd'T'HH:mm:ss", "2019-07-04T21:00:00", "yyyy-MM-dd'T'HH:mm:ss")</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Result:</div>
<div class="content">
<pre>0</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_jsonpath"><a class="anchor" href="#_jsonpath"></a>JsonPath</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_selectobject_json_string_path"><a class="anchor" href="#_selectobject_json_string_path"></a><code>select(object json, string path)</code></h3>
<div class="paragraph">
<p>Evaluates JsonPath expression and returns the resulting JSON object.
It uses the <a href="https://github.com/json-path/JsonPath">Jayway JsonPath implementation</a> and fully supports <a href="https://goessner.net/articles/JsonPath/">JsonPath specification</a>.</p>
</div>
<div class="paragraph">
<p><strong>Example</strong></p>
</div>
<div class="listingblock">
<div class="title">Payload</div>
<div class="content">
<pre>{
  "store": {
    "book": [
      {
        "category": "reference",
        "author": "Nigel Rees",
        "title": "Sayings of the Century",
        "price": 8.95
      },
      {
        "category": "fiction",
        "author": "Evelyn Waugh",
        "title": "Sword of Honour",
        "price": 12.99
      },
      {
        "category": "fiction",
        "author": "Herman Melville",
        "title": "Moby Dick",
        "isbn": "0-553-21311-3",
        "price": 8.99
      },
      {
        "category": "fiction",
        "author": "J. R. R. Tolkien",
        "title": "The Lord of the Rings",
        "isbn": "0-395-19395-8",
        "price": 22.99
      }
    ]
  }
}</pre>
</div>
</div>
<div class="listingblock">
<div class="title">DataSonnet map:</div>
<div class="content">
<pre>{
    author: DS.JsonPath.select(payload, "$..book[-2:]..author")[0]
}</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Result</div>
<div class="content">
<pre>{
    "author": "Herman Melville"
}</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_util"><a class="anchor" href="#_util"></a>Util</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_selectobject_obj_string_path"><a class="anchor" href="#_selectobject_obj_string_path"></a><code>select(object obj, string path)</code></h3>
<div class="paragraph">
<p>Returns a value inside the object by given path separated by dot ('.').</p>
</div>
<div class="paragraph">
<p><strong>Example</strong></p>
</div>
<div class="listingblock">
<div class="title">Payload</div>
<div class="content">
<pre>{
  "name": "Foo",
  "language": {
      "name": "Java",
      "version": "1.8"
  }
}</pre>
</div>
</div>
<div class="listingblock">
<div class="title">DataSonnet map:</div>
<div class="content">
<pre>{
  language: DS.Util.select(payload, 'language.name')
}</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Result</div>
<div class="content">
<pre>{
   "language": "Java"
}</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_filterexarray_objects_string_key_string_value_function_filter_funcfunctionvalue1_value2_value1_value2"><a class="anchor" href="#_filterexarray_objects_string_key_string_value_function_filter_funcfunctionvalue1_value2_value1_value2"></a><code>filterEx(array objects, string key, string value, function filter_func=function(value1, value2) value1 == value2)</code></h3>
<div class="paragraph">
<p>Filters array of objects by given condition.</p>
</div>
<div class="paragraph">
<p><strong>Example</strong></p>
</div>
<div class="listingblock">
<div class="title">Payload</div>
<div class="content">
<pre>{
   "languages": [
     {
       "name": "Foo",
       "language": "Java"
     },
     {
       "name": "Bar",
       "language": "Scala"
     },
     {
       "name": "FooBar",
       "language": "Java"
     },
     {
       "name": "FooBar",
       "language": "C++"
     }
   ]
 }</pre>
</div>
</div>
<div class="listingblock">
<div class="title">DataSonnet map:</div>
<div class="content">
<pre>{
  nonJavaLanguages: DS.Util.filterEx(payload.languages, 'language', 'Java', function(x, y) x != y)
}</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Result</div>
<div class="content">
<pre>[
 {
   "name": "Bar",
   "language": "Scala"
 },
 {
   "name": "FooBar",
   "language": "C++"
 }
]</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_groupbyarray_arr_string_keyname"><a class="anchor" href="#_groupbyarray_arr_string_keyname"></a><code>groupBy(array arr, string keyName)</code></h3>
<div class="paragraph">
<p>Partitions an array into a Object that contains Arrays, according to the discriminator key you define.
The discriminator can be a path inside the objects to group, e.g. 'language.name'</p>
</div>
<div class="paragraph">
<p><strong>Example</strong></p>
</div>
<div class="listingblock">
<div class="title">Payload</div>
<div class="content">
<pre>{
  "languages": [
    {
      "name": "Foo",
      "language": {
          "name": "Java",
          "version": "1.8"
      }
    },
    {
      "name": "Bar",
      "language": {
          "name": "Scala",
          "version": "1.0"
      }
    },
    {
      "name": "FooBar",
      "language": {
          "name": "Java",
          "version": "1.7"
      }
    }
  ]
}</pre>
</div>
</div>
<div class="listingblock">
<div class="title">DataSonnet map:</div>
<div class="content">
<pre>{
  languageGroups: DS.Util.groupBy(payload.languages, 'language.name')
}</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Result</div>
<div class="content">
<pre>{
    "languageGroups": {
       "Java": [
          {
             "language": {
                "name": "Java",
                "version": "1.8"
             },
             "name": "Foo"
          },
          {
             "language": {
                "name": "Java",
                "version": "1.7"
             },
             "name": "FooBar"
          }
       ],
       "Scala": [
          {
             "language": {
                "name": "Scala",
                "version": "1.0"
             },
             "name": "Bar"
          }
       ]
    }
}</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_removeobject_obj_string_keyname"><a class="anchor" href="#_removeobject_obj_string_keyname"></a><code>remove(object obj, string keyName)</code></h3>
<div class="paragraph">
<p>Removes a property with given name from the object and returns the remaining object</p>
</div>
<div class="paragraph">
<p><strong>Example</strong></p>
</div>
<div class="listingblock">
<div class="title">Payload</div>
<div class="content">
<pre>{
   "availableSeats": 45,
   "airlineName": "Delta",
   "aircraftBrand": "Boeing",
   "aircraftType": "717",
   "departureDate": "01/20/2019",
   "origin": "PHX",
   "destination": "SEA"
 }</pre>
</div>
</div>
<div class="listingblock">
<div class="title">DataSonnet map:</div>
<div class="content">
<pre>DS.Util.remove(payload, 'availableSeats')</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Result</div>
<div class="content">
<pre>{
   "airlineName": "Delta",
   "aircraftBrand": "Boeing",
   "aircraftType": "717",
   "departureDate": "01/20/2019",
   "origin": "PHX",
   "destination": "SEA"
 }</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_removeallobject_obj_array_keynames"><a class="anchor" href="#_removeallobject_obj_array_keynames"></a><code>removeAll(object obj, array keyNames)</code></h3>
<div class="paragraph">
<p>Removes all properties with names from a provided list of strings from the object and returns the remaining object</p>
</div>
<div class="paragraph">
<p><strong>Example</strong></p>
</div>
<div class="listingblock">
<div class="title">Payload</div>
<div class="content">
<pre>{
   "availableSeats": 45,
   "airlineName": "Delta",
   "aircraftBrand": "Boeing",
   "aircraftType": "717",
   "departureDate": "01/20/2019",
   "origin": "PHX",
   "destination": "SEA"
 }</pre>
</div>
</div>
<div class="listingblock">
<div class="title">DataSonnet map:</div>
<div class="content">
<pre>DS.Util.removeAll(payload, ['availableSeats', 'aircraftType', 'aircraftBrand'])</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Result</div>
<div class="content">
<pre>{
   "airlineName": "Delta",
   "departureDate": "01/20/2019",
   "origin": "PHX",
   "destination": "SEA"
 }</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_deepflattenarraysarray_arr"><a class="anchor" href="#_deepflattenarraysarray_arr"></a><code>deepFlattenArrays(array arr)</code></h3>
<div class="paragraph">
<p>Flattens multiple nested arrays into a single array.</p>
</div>
<div class="paragraph">
<p><strong>Example</strong></p>
</div>
<div class="listingblock">
<div class="title">Payload</div>
<div class="content">
<pre>[
    1,
    2,
    [
      3
    ],
    [
      4,
      [
        5,
        6,
        7
      ],
      {
        "x": "y"
      }
    ]
]</pre>
</div>
</div>
<div class="listingblock">
<div class="title">DataSonnet map:</div>
<div class="content">
<pre>DS.Util.flattenArrays(payload)</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Result</div>
<div class="content">
<pre>[
     1,
     2,
     4,
     5,
     6,
     7,
     {
        "x": "y"
     }
]</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_reversearray_arr"><a class="anchor" href="#_reversearray_arr"></a><code>reverse(array arr)</code></h3>
<div class="paragraph">
<p>Returns an array with elements in reverse order.</p>
</div>
<div class="paragraph">
<p><strong>Example</strong></p>
</div>
<div class="listingblock">
<div class="title">Payload</div>
<div class="content">
<pre>[
    "a",
    "b",
    "c",
    "d"
]</pre>
</div>
</div>
<div class="listingblock">
<div class="title">DataSonnet map:</div>
<div class="content">
<pre>DS.Util.reverse(payload)</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Result</div>
<div class="content">
<pre>[
    "d",
    "c",
    "b",
    "a",
]</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_parsedoublestring_str"><a class="anchor" href="#_parsedoublestring_str"></a><code>parseDouble(string str)</code></h3>
<div class="paragraph">
<p>Parses a string which contains a double number and returns its numeric representation</p>
</div>
<div class="paragraph">
<p><strong>Example</strong></p>
</div>
<div class="listingblock">
<div class="title">Payload</div>
<div class="content">
<pre>{
    "numberAsString": "123.45679"
}</pre>
</div>
</div>
<div class="listingblock">
<div class="title">DataSonnet map:</div>
<div class="content">
<pre>{
    num: DS.Util.parseDouble(payload.numberAsString)
}</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Result</div>
<div class="content">
<pre>{
    "num": 123.45679
}</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_duplicatesarray_arr_function_keyfid_boolean_settrue"><a class="anchor" href="#_duplicatesarray_arr_function_keyfid_boolean_settrue"></a><code>duplicates(array arr, function keyF=id, boolean set=true)</code></h3>
<div class="paragraph">
<p>Returns an array containing duplicate elements from input array. An optional key function returns a value which will be used as a comparison key. If <code>set</code> parameter is set to true, only the first duplicate value will be included.</p>
</div>
<div class="paragraph">
<p><strong>Example</strong></p>
</div>
<div class="listingblock">
<div class="title">Payload</div>
<div class="content">
<pre>[
    {
      "language": {
        "name": "Java8",
        "version": "1.8"
      }
    },
    {
      "language": {
        "name": "Java8",
        "version": "1.8.0"
      }
    },
    {
      "language": {
        "name": "Scala",
        "version": "2.13.0"
      }
    }
]</pre>
</div>
</div>
<div class="listingblock">
<div class="title">DataSonnet map:</div>
<div class="content">
<pre>DS.Util.duplicates(payload, function(x) x.language.name)</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Result</div>
<div class="content">
<pre>[
  {
    "language": {
      "name": "Java8",
      "version":"1.8.0"
    }
  }
]</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_sumarray_arr"><a class="anchor" href="#_sumarray_arr"></a><code>sum(array arr)</code></h3>
<div class="paragraph">
<p>Returns sum of all elements in the array.</p>
</div>
<div class="paragraph">
<p><strong>Example</strong></p>
</div>
<div class="listingblock">
<div class="title">Payload</div>
<div class="content">
<pre>[ 10, 20, 30 ]</pre>
</div>
</div>
<div class="listingblock">
<div class="title">DataSonnet map:</div>
<div class="content">
<pre>DS.Util.sum(payload)</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Result</div>
<div class="content">
<pre>60</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_rounddouble_num_int_precision"><a class="anchor" href="#_rounddouble_num_int_precision"></a><code>round(double num, int precision)</code></h3>
<div class="paragraph">
<p>Rounds a double to the number of digits after the decimal point</p>
</div>
<div class="paragraph">
<p><strong>Example</strong></p>
</div>
<div class="listingblock">
<div class="title">Payload</div>
<div class="content">
<pre>{
    "num": 123.562567558
}</pre>
</div>
</div>
<div class="listingblock">
<div class="title">DataSonnet map:</div>
<div class="content">
<pre>DS.Util.round(payload.num, 6)</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Result</div>
<div class="content">
<pre>123.562568</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_countsarray_arr_function_keyfid"><a class="anchor" href="#_countsarray_arr_function_keyfid"></a><code>counts(array arr, function keyF=id)</code></h3>
<div class="paragraph">
<p>Returns an object where keys are the results of calling keyF on the values, and the values are the counts of values that produced the corresponding key.</p>
</div>
<div class="paragraph">
<p><strong>Example</strong></p>
</div>
<div class="listingblock">
<div class="title">Payload</div>
<div class="content">
<pre>[
    {
      "name": "Foo",
      "language": {
        "name": "Java",
        "version": "1.8"
      }
    },
    {
      "name": "Bar",
      "language": {
        "name": "Scala",
        "version": "1.0"
      }
    },
    {
      "name": "FooBar",
      "language": {
        "name": "Java",
        "version": "1.7"
      }
    }
  ]</pre>
</div>
</div>
<div class="listingblock">
<div class="title">DataSonnet map:</div>
<div class="content">
<pre>DS.Util.counts(payload, function(x) x.language.name);</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Result</div>
<div class="content">
<pre>{
    "Java": 2,
    "Scala": 1
}</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_maptoobjectarr_keyf_valuefid"><a class="anchor" href="#_maptoobjectarr_keyf_valuefid"></a><code>mapToObject(arr, keyF, valueF=id)</code></h3>
<div class="paragraph">
<p>Maps an array into an object, where the keys are the result of calling keyF on each value (which becomes the value at the key). If valueF is provided it gets run on the value. Duplicate keys are removed.</p>
</div>
<div class="paragraph">
<p><strong>Example</strong></p>
</div>
<div class="listingblock">
<div class="title">Payload</div>
<div class="content">
<pre>[
    {
      "name": "Foo",
      "language": {
        "name": "Java",
        "version": "1.8"
      }
    },
    {
      "name": "Bar",
      "language": {
        "name": "Scala",
        "version": "1.0"
      }
    },
    {
      "name": "FooBar",
      "language": {
        "name": "C++",
        "version": "n/a"
      }
    }
  ]</pre>
</div>
</div>
<div class="listingblock">
<div class="title">DataSonnet map:</div>
<div class="content">
<pre>DS.Util.mapToObject(payload, function(x) x.language.name, function(v) v.language);</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Result</div>
<div class="content">
<pre>{
 "Java": {
   "name": "Java",
   "version": "1.8"
 },
 "C++": {
   "name": "C++",
   "version": "n/a"
 },
 "Scala": {
   "name": "Scala",
   "version": "1.0"
 }
};</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_regex"><a class="anchor" href="#_regex"></a>Regex</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_regexfullmatchstring_pattern_string_input"><a class="anchor" href="#_regexfullmatchstring_pattern_string_input"></a><code>regexFullMatch(string pattern, string input)</code></h3>
<div class="paragraph">
<p>Matches the entire input against the pattern (anchored start and end). If there&#8217;s no match, returns <code>null</code>. If there&#8217;s a match, returns a JSON object which has the following structure:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>string</code> - the matched string;</p>
</li>
<li>
<p><code>captures</code> - array of captured subgroups in the match, if any;</p>
</li>
<li>
<p><code>namedCaptures</code> - map of named subgroups, if any;</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Example</strong></p>
</div>
<div class="listingblock">
<div class="title">DataSonnet map:</div>
<div class="content">
<pre>DS.Regex.regexFullMatch(@'h(?P&lt;mid&gt;.*)o', 'hello');</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Result</div>
<div class="content">
<pre>{
  "captures": [
    "ell"
  ],
  "namedCaptures": {
    "mid": "ell"
  },
  "string": "hello"
}</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_regexpartialmatchstring_pattern_string_input"><a class="anchor" href="#_regexpartialmatchstring_pattern_string_input"></a><code>regexPartialMatch(string pattern, string input)</code></h3>
<div class="paragraph">
<p>Matches the input against the pattern (unanchored). If there&#8217;s no match, returns <code>null</code>. If there&#8217;s a match, returns a JSON object which has the following structure:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>string</code> - the matched string;</p>
</li>
<li>
<p><code>captures</code> - array of captured subgroups in the match, if any;</p>
</li>
<li>
<p><code>namedCaptures</code> - map of named subgroups, if any;</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Example</strong></p>
</div>
<div class="listingblock">
<div class="title">DataSonnet map:</div>
<div class="content">
<pre>DS.Regex.regexPartialMatch(@'e(?P&lt;mid&gt;.*)o', 'hello')</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Result</div>
<div class="content">
<pre>{
  "captures": [
    "ll"
  ],
  "namedCaptures": {
    "mid": "ll"
  },
  "string": "ello"
}</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_regexscanstring_pattern_string_input"><a class="anchor" href="#_regexscanstring_pattern_string_input"></a><code>regexScan(string pattern, string input)</code></h3>
<div class="paragraph">
<p>Finds all matches of the input against the pattern. If there are any matches, returns an array of JSON objects which have the following structure:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>string</code> - the matched string;</p>
</li>
<li>
<p><code>captures</code> - array of captured subgroups in the match, if any;</p>
</li>
<li>
<p><code>namedCaptures</code> - map of named subgroups, if any;</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Example</strong></p>
</div>
<div class="listingblock">
<div class="title">DataSonnet map:</div>
<div class="content">
<pre>DS.Regex.regexScan(@'(?P&lt;user&gt;[a-z]*)@(?P&lt;domain&gt;[a-z]*).org', 'modus@datasonnet.org,box@datasonnet.org')</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Result</div>
<div class="content">
<pre>[
    {
        "captures": [
            "modus",
            "datasonnet"
        ],
        "namedCaptures": {
            "domain": "datasonnet",
            "user": "modus"
        },
        "string": "modus@datasonnet.org"
    },
    {
        "captures": [
            "box",
            "datasonnet"
        ],
        "namedCaptures": {
            "domain": "datasonnet",
            "user": "box"
        },
        "string": "box@datasonnet.org"
    }
]</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_regexquotemetastring_str"><a class="anchor" href="#_regexquotemetastring_str"></a><code>regexQuoteMeta(string str)</code></h3>
<div class="paragraph">
<p>Returns a literal pattern string for the specified string.</p>
</div>
<div class="paragraph">
<p><strong>Example</strong></p>
</div>
<div class="listingblock">
<div class="title">DataSonnet map:</div>
<div class="content">
<pre>DS.Regex.regexQuoteMeta(@'1.5-2.0?')</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Result</div>
<div class="content">
<pre>"1\\.5-2\\.0\\?"</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_regexreplacestring_str_string_pattern_string_replacement"><a class="anchor" href="#_regexreplacestring_str_string_pattern_string_replacement"></a><code>regexReplace(string str, string pattern, string replacement)</code></h3>
<div class="paragraph">
<p>Returns the input with the first match replaced by <code>replacement</code> string.</p>
</div>
<div class="paragraph">
<p><strong>Example</strong></p>
</div>
<div class="listingblock">
<div class="title">DataSonnet map:</div>
<div class="content">
<pre>DS.Regex.regexReplace('wishyfishyisishy', @'ish', 'and')</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Result</div>
<div class="content">
<pre>"wandyfishyisishy"</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_regexglobalreplacestring_str_string_pattern_string_replacement"><a class="anchor" href="#_regexglobalreplacestring_str_string_pattern_string_replacement"></a><code>regexGlobalReplace(string str, string pattern, string replacement)</code></h3>
<div class="paragraph">
<p>Returns the input with all matches replaced by <code>replacement</code> string.</p>
</div>
<div class="paragraph">
<p><strong>Example</strong></p>
</div>
<div class="listingblock">
<div class="title">DataSonnet map:</div>
<div class="content">
<pre>DS.Regex.regexGlobalReplace('wishyfishyisishy', @'ish', 'and')</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Result</div>
<div class="content">
<pre>"wandyfandyisandy"</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_regexglobalreplacestring_str_string_pattern_function_replacement"><a class="anchor" href="#_regexglobalreplacestring_str_string_pattern_function_replacement"></a><code>regexGlobalReplace(string str, string pattern, function replacement)</code></h3>
<div class="paragraph">
<p>Returns the input with all matches replaced by the result of the <code>replacement</code> function. The function must return string result and take a single object as an argument in the following structure:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>string</code> - the matched string;</p>
</li>
<li>
<p><code>captures</code> - array of captured subgroups in the match, if any;</p>
</li>
<li>
<p><code>namedCaptures</code> - map of named subgroups, if any;</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Example</strong></p>
</div>
<div class="listingblock">
<div class="title">DataSonnet map:</div>
<div class="content">
<pre>local square(obj) = std.toString(std.pow(std.parseInt(obj.string), 2));

DS.Regex.regexGlobalReplace("xxx2yyy4zzz6aaa", "\\d", square)</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Result</div>
<div class="content">
<pre>"xxx4yyy16zzz36aaa"</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_url"><a class="anchor" href="#_url"></a>URL</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_encodestring_data_string_encodingutf_8"><a class="anchor" href="#_encodestring_data_string_encodingutf_8"></a><code>encode(string data, string encoding="UTF-8")</code></h3>
<div class="paragraph">
<p>Translates a string into <code>application/x-www-form-urlencoded</code> format using the supplied encoding scheme to obtain the bytes for unsafe characters. The default encoding is <code>UTF-8</code>.</p>
</div>
<div class="paragraph">
<p><strong>Example</strong></p>
</div>
<div class="listingblock">
<div class="title">DataSonnet map:</div>
<div class="content">
<pre>DS.URL.encode('Hello World')</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Result</div>
<div class="content">
<pre>"Hello+World"</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_decodestring_data_string_encodingutf_8"><a class="anchor" href="#_decodestring_data_string_encodingutf_8"></a><code>decode(string data, string encoding="UTF-8")</code></h3>
<div class="paragraph">
<p>Decodes a application/x-www-form-urlencoded string using a specific encoding scheme. The supplied encoding is used to determine what characters are represented by any consecutive sequences of the form "%xy".</p>
</div>
<div class="paragraph">
<p><strong>Example</strong></p>
</div>
<div class="listingblock">
<div class="title">DataSonnet map:</div>
<div class="content">
<pre>DS.URL.decode('Hello+World')</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Result</div>
<div class="content">
<pre>"Hello World"</pre>
</div>
</div>
</div>
</div>
</div>
</article>
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
  </div>
</main>
</div>
<footer class="footer">
  <p>This page was built using the Antora default UI.</p>
  <p>The source code for this UI is licensed under the terms of the MPL-2.0 license.</p>
</footer>
<script src="../../_/js/site.js"></script>
<script async src="../../_/js/vendor/highlight.js"></script>
  </body>
</html>
